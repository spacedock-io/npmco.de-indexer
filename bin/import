#!/usr/bin/env node
var zlib = require('zlib'),
    tar = require('tar'),
    request = require('request'),
    Importer = require('../lib/import'),
    elasticstream = require('elasticstream');

var package = process.argv[2].split('@'),
    name = package[0],
    version = package[1];

request('http://registry.npmjs.org/' + name + '/-/' + name + '-' + version + '.tgz')
  .pipe(zlib.createGunzip())
  .pipe(tar.Parse())
  .pipe(Importer({ name: name, version: version }))
  .pipe(elasticstream({ index: 'files', type: 'file' }));
